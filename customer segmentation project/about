info:
python library and syntax

# data collection and processing
import pandas as pd
. Pandas helps us load, clean, process, and analyze tabular data.
data = pd.read_csv("cleaned_data.csv", encoding='latin1', on_bad_lines='skip', engine='python')
. encoding='latin1' avoids errors when the file has special characters.
. on_bad_lines='skip' prevents code from breaking due to corrupted or misformatted rows.
. engine='python' makes pandas more flexible with complicated CSV structures.
print(data.shape)  ->Shows number of rows and columns.
print(data.info())  ->Displays column names, data types, and number of non-null values.
print(data.isnull().sum())  ->Counts missing values in each column.
print(data.duplicated().sum())  ->Checks how many duplicated rows exist.
from sklearn.preprocessing import StandardScaler
. Used to scale numeric features for machine learning models.
print(data.describe())  ->Shows summary statistics of numerical columns.

# eda
import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd
.matplotlib → basic plotting
.seaborn → attractive statistical charts
.pandas → data manipulation
plt.figure(figsize=(10,5)) 
sns.barplot(x=top_products.values, y=top_products.index, palette='viridis')
.barplot() takes values (quantities) and labels (product names)
.palette='viridis' for colors
plt.figure(figsize=(8,5)) 
sns.histplot(customer_summary['TotalSpend'], bins=50, kde=True)
.bins=50 → more detailed distribution
.kde=True → adds smooth curve for clarity
data['InvoiceMonth'] = data['InvoiceDate'].dt.to_period('M')
.dt.to_period('M') converts timestamp → monthly period.
plt.figure(figsize=(10,5)) 
sns.lineplot(x='InvoiceMonth', y='TotalPrice', data=monthly_sales, marker='o')
. marker='o' shows actual data points.
plt.figure(figsize=(6,4))
sns.heatmap(data[['Quantity', 'UnitPrice', 'TotalPrice']].corr(), annot=True, cmap='coolwarm')
.corr() computes correlation matrix
.annot=True shows numeric values
.Heatmap visualizes relationships clearly

# market basket analysis
import pandas as pd
from mlxtend.frequent_patterns import fpgrowth, association_rules
import warnings
warnings.filterwarnings('ignore')
. pandas → data loading + cleaning
. fpgrowth → fast frequent itemset mining
. association_rules → generates rules from itemsets
. Warnings ignored to keep output clean
country_choice = input("Enter country for Market Basket Analysis: ").strip().lower()
.strip() removes spaces
.lower() makes input match dataset values

# customer segmentation
import pandas as pd
from sklearn.preprocessing import StandardScaler
from sklearn.cluster import KMeans
. pandas → data loading + grouping
. StandardScaler → normalize RFM values
. KMeans → clustering customers into segments
num_clusters = min(4, len(customer_data))
kmeans = KMeans(n_clusters=num_clusters, random_state=42)
customer_data['Cluster'] = kmeans.fit_predict(scaled_df)
. fit_predict() trains and assigns clusters.

# visualization and business insights
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import networkx as nx
import os
. pandas – to load/process CSV files
. matplotlib / seaborn – for different types of visual charts
. networkx – to draw association-rule networks
. os – to check if required files exist before executing code
if os.path.exists("customer_segments.csv") and os.path.exists("association_rules.csv"):
    customer_data = pd.read_csv("customer_segments.csv")
    rules = pd.read_csv("association_rules.csv")
    print("✅ Data loaded successfully.")
else:
    print("⚠️ Missing saved files. Please run Part 3 (Market Basket) and Part 4 (Clustering) first.")
    exit()
. customer_segments.csv → output from clustering
. association_rules.csv → output from market basket analysis
. os.path.exists() returns True if file found.
plt.figure(figsize=(8,5))
sns.countplot(x='Cluster', data=customer_data, palette='coolwarm')
. countplot() automatically counts how many times each cluster label appears.
. palette='coolwarm' adds color.
. plt.show() displays the bar chart.
rules['antecedents'] = rules['antecedents'].astype(str)
rules['consequents'] = rules['consequents'].astype(str)
. astype(str) converts any Python object into a string.
G = nx.from_pandas_edgelist(rules.head(15), 'antecedents', 'consequents', ['lift'])
. 'lift' = weight of connection
nx.draw(G, with_labels=True, node_color='lightgreen', node_size=2000, font_size=9)
plt.title("Frequent Product Associations Network")
plt.show()
. Draws a visual network map showing product relationships.
